<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hunguigu.dao.CommodityDao">
  <resultMap id="commoditymap" type="Commodity">
    <collection property="commodityType" javaType="CommodityType"
                column="commodity_type_id" select="com.hunguigu.dao.CommodityTypeDao.queryById"
                fetchType="lazy">
    </collection>
    <collection property="brand" javaType="Brand"
                column="brand_id" select="com.hunguigu.dao.BrandDao.queryById"
                fetchType="lazy">
    </collection>
  </resultMap>

<select id="query" parameterType="Commodity" resultMap="commoditymap">
    SELECT * FROM commodity
    <where>
      <if test="name!=null">and name like concat('%',#{name},'%')</if>
    </where>
  </select>

  <select id="queryTotal" parameterType="Commodity" resultType="int">
    SELECT count(*) FROM commodity
    <where>
      <if test="name!=null">and name like concat('%',#{name},'%')</if>
    </where>
  </select>

<insert id="insert" parameterType="Commodity">
        insert into commodity values(null,#{name},#{specifications},#{commodityType.id},#{brand.id},#{img},#{remark})
    </insert>

  <delete id="delete" parameterType="int">
        delete from commodity where id={id}
    </delete>

  <update id="update" parameterType="Commodity">
        update commodity set name=#{name},specifications=#{specifications},commodityType=#{commodityType.id},brand=#{brand.id},img=#{img},remark=#{remark} where id=#{id}
  </update>

  <select id="queryById" parameterType="int" resultType="Commodity">
        SELECT * FROM commodity WHERE id=#{id}
  </select>


</mapper>